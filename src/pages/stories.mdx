---
title: Stories
---

import Layout from "../components/Layout"
import StoryCard from "../components/StoryCard"
import Gallery from "../components/Gallery"
import { graphql, Link } from "gatsby"
import { jsx } from "theme-ui"
import Dropdown from "../components/Dropdown"
import SearchText from "../components/SearchText"

<Layout>

# Listen to stories

<SearchText />

<Dropdown content={props.data.tags} contentName="Topic" contentSlug="tag" />

<Dropdown content={props.data.states} contentName="State" contentSlug="state" />

<Dropdown
  content={props.data.schools}
  contentName="School"
  contentSlug="school"
/>

<br />
<br />

<br/>
<Gallery n={3}>
{props.data.stories.edges.map((edge, i) => (
	<StoryCard
        id={edge.node.id}
		photoUrl={edge.node.data.Photo ? edge.node.data.Photo[0].thumbnails.large.url : ''}
		title={edge.node.data.Story_Name}
		author={edge.node.data.Author}
		audio={edge.node.data.Audio ? (edge.node.data.Audio[0].url) : ''}
	/>
))}
</Gallery>
</Layout>

export const pageQuery = graphql`
  query {
    stories: allAirtable(
      filter: {
        table: { eq: "Stories" }
        data: { Status: { eq: "Published" } }
      }
    ) {
      edges {
        node {
          id
          data {
            Author
            Status
            Story_Name
            Photo {
              thumbnails {
                large {
                  url
                }
              }
            }
            Audio {
              url
            }
            School
            Tags
            Grade
            Transcript
          }
        }
      }
    }
    tags: allAirtable(
      filter: {
        table: { eq: "Stories" }
        data: { Status: { eq: "Published" } }
      }
    ) {
      group(field: data___Tags) {
        fieldValue
      }
    }
    states: allAirtable(
      filter: {
        table: { eq: "Stories" }
        data: { Status: { eq: "Published" } }
      }
    ) {
      group(field: data___State) {
        fieldValue
      }
    }
    schools: allAirtable(
      filter: {
        table: { eq: "Stories" }
        data: { Status: { eq: "Published" } }
      }
    ) {
      group(field: data___School) {
        fieldValue
      }
    }
  }
`
